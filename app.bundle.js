(()=>{"use strict";var t={56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,o=0;o<e.length;o++)if(e[o].identifier===t){n=o;break}return n}function o(t,o){for(var a={},s=[],i=0;i<t.length;i++){var l=t[i],d=o.base?l[0]+o.base:l[0],c=a[d]||0,p="".concat(d," ").concat(c);a[d]=c+1;var u=n(p),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)e[u].references++,e[u].updater(h);else{var g=r(h,o);o.byIndex=i,e.splice(i,0,{identifier:p,updater:g,references:1})}s.push(p)}return s}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var a=o(t=t||[],r=r||{});return function(t){t=t||[];for(var s=0;s<a.length;s++){var i=n(a[s]);e[i].references--}for(var l=o(t,r),d=0;d<a.length;d++){var c=n(a[d]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}a=l}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},159:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",o=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),o&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),o&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,o,r,a){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(o)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(s[l]=!0)}for(var d=0;d<t.length;d++){var c=[].concat(t[d]);o&&s[c[0]]||(void 0!==a&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),e.push(c))}},e}},365:(t,e,n)=>{n.d(e,{A:()=>i});var o=n(601),r=n.n(o),a=n(314),s=n.n(a)()(r());s.push([t.id,'/* styles.css - Option 1: Clean & Modern Layout */\n\n/* Base Reset & Body Styling */\n* {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n}\n\nbody {\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n    background-color: #393E41; /* Main light background */\n    color: #393E41; /* Default text color */\n    display: flex; /* Use flex to create sidebar + main layout */\n    min-height: 100vh; /* Full viewport height */\n}\n\n/* -------------------- Sidebar Styling (Left Column) -------------------- */\n#sidebar {\n    width: 250px; /* Fixed width for sidebar */\n    background-color: #727072; /* Dark grey sidebar background */\n    color: #F6F7EB; /* Light text on dark background */\n    padding: 25px;\n    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);\n    display: flex;\n    flex-direction: column;\n}\n\n#sidebar h1 {\n    font-size: 1.8em;\n    margin-bottom: 30px;\n    color: #F6F7EB;\n}\n\n#sidebar .nav-section {\n    margin-bottom: 30px;\n}\n\n#sidebar .nav-section h2 {\n    font-size: 1.1em;\n    color: rgba(246, 247, 235, 0.7); /* Lighter grey for section titles */\n    border-bottom: 1px solid rgba(246, 247, 235, 0.2);\n    padding-bottom: 8px;\n    margin-bottom: 15px;\n}\n\n#sidebar ul {\n    list-style: none;\n    padding: 0;\n}\n\n#sidebar ul li {\n    margin-bottom: 10px;\n}\n\n#sidebar ul li a {\n    color: #F6F7EB;\n    text-decoration: none;\n    padding: 8px 10px;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    border-radius: 6px;\n    transition: background-color 0.2s, color 0.2s;\n}\n\n#sidebar ul li a i { /* For icons if you add them */\n    font-size: 1.2em;\n}\n\n#sidebar ul li a:hover {\n    background-color: rgba(246, 247, 235, 0.1); /* Light hover effect */\n}\n\n/* Project Specific Styling */\n#sidebar ul.project-list li {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-left: 15px; /* Indent projects slightly */\n}\n\n#sidebar ul.project-list li span {\n    flex-grow: 1;\n    color: #F6F7EB;\n    padding: 8px 0;\n    cursor: pointer;\n}\n\n#sidebar ul.project-list li button.delete-project-btn {\n    background-color: transparent;\n    color: rgba(246, 247, 235, 0.5);\n    border: none;\n    padding: 5px;\n    cursor: pointer;\n    font-size: 0.9em;\n    border-radius: 4px;\n    transition: color 0.2s, background-color 0.2s;\n}\n\n#sidebar ul.project-list li button.delete-project-btn:hover {\n    color: #F6F7EB;\n    background-color: rgba(246, 247, 235, 0.2);\n}\n\n\n/* -------------------- Main Content Area Styling (Right Column) -------------------- */\n#app-container { \n    flex-grow: 1; /* Takes remaining space */\n    padding: 30px;\n    display: flex;\n    flex-direction: column;\n    gap: 20px; /* Space between header/form and list */\n    color: #F6F7EB;\n}\n\n/* Add Task Form Styling */\n#task-form {\n    display: flex;\n    gap: 10px;\n    background-color: #ffffff; /* White background for the form itself */\n    padding: 15px;\n    border-radius: 8px;\n    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);\n}\n\n#task-form input[type="text"],\n#task-form select,\n#task-form input[type="date"] {\n    flex-grow: 1;\n    padding: 10px 12px;\n    border: 1px solid #ddd;\n    border-radius: 6px;\n    font-size: 0.95em;\n    color: #393E41;\n}\n#task-form input[type="text"]:focus,\n#task-form select:focus,\n#task-form input[type="date"]:focus {\n    border-color: #557A95; /* A subtle blue accent for focus */\n    outline: none;\n}\n#task-form button {\n    padding: 10px 20px;\n    background-color: #557A95; /* A moderate blue for action buttons */\n    color: white;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95em;\n    transition: background-color 0.2s;\n}\n#task-form button:hover {\n    background-color: #436587;\n}\n\n/* Task List Styling */\n#task-list-root {\n    list-style: none;\n    padding: 0;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n#task-list-root li {\n    display: grid;\n    grid-template-columns: 1fr auto; /* Title/Metadata | Controls */\n    align-items: center;\n    gap: 15px;\n    padding: 12px 15px;\n    background-color: #ffffff; /* White background for task cards */\n    border-radius: 8px;\n    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);\n    transition: transform 0.2s, box-shadow 0.2s;\n    border-left: 5px solid transparent; /* For priority indication */\n    font-size: 0.95em;\n    color: #393E41;\n}\n#task-list-root li:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n\n/* Task Title and Metadata Container */\n.task-title-container {\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    gap: 8px; /* Space between priority, date, and title */\n    color: #393E41;\n}\n\n.task-title-container span { /* The actual task title text */\n    flex-basis: 100%; /* Makes the title itself take full width if wrapped */\n    font-weight: 500;\n    order: 3; /* Places the title after priority and date */\n}\n\n.task-priority,\n.task-due-date,\n.project-badge {\n    font-size: 0.75em;\n    font-weight: bold;\n    padding: 3px 7px;\n    border-radius: 4px;\n    text-transform: uppercase;\n    order: 1; /* Places priority first */\n}\n.task-due-date {\n    order: 2; /* Places date second */\n    font-weight: normal;\n    background-color: #E0E0E0; /* Light grey background */\n    color: #666;\n}\n\n.project-badge{\n    border-color: #E9B872;\n    background-color: #e9c49077;\n    color: #E9B872;\n}\n\n/* Priority Colors (for left border and text) */\n.priority-high {\n    border-color: #E74C3C; /* Red */\n    background-color: #FDE8E8;\n    color: #E74C3C;\n}\n.priority-medium {\n    border-color: #F1C40F; /* Yellow */\n    background-color: #FFFDE8;\n    color: #F1C40F;\n}\n.priority-low {\n    border-color: #2ECC71; /* Green */\n    background-color: #E8FDEE;\n    color: #2ECC71;\n}\n\n/* Completion Styles */\n#task-list-root li.completed {\n    opacity: 0.7;\n    background-color: #f8f8f8;\n    border-left-color: #ccc;\n}\n#task-list-root li.completed .task-title-container span {\n    text-decoration: line-through;\n    color: #888;\n}\n#task-list-root li.completed .task-priority,\n#task-list-root li.completed .task-due-date {\n    opacity: 0.6;\n}\n\n/* Controls Group (Checkbox, Edit, Delete) */\n.task-controls {\n    display: flex;\n    align-items: center;\n    gap: 8px; /* Space between control elements */\n}\n.task-controls input[type="checkbox"] {\n    width: 20px;\n    height: 20px;\n    cursor: pointer;\n    flex-shrink: 0;\n}\n.task-controls button {\n    padding: 6px 10px;\n    border-radius: 6px;\n    font-size: 0.85em;\n    transition: background-color 0.2s;\n    height: 32px; /* Consistent height */\n    line-height: 1.2;\n    white-space: nowrap; /* Prevent buttons from wrapping text */\n}\n\n/* Specific Button Styles (Overrides general button styles) */\n.btn-edit {\n    background-color: #557A95; /* Blue for Edit */\n    color: white;\n    border: none;\n}\n.btn-edit:hover {\n    background-color: #436587;\n}\n.btn-del {\n    background-color: #E74C3C; /* Red for Delete */\n    color: white;\n    border: none;\n}\n.btn-del:hover {\n    background-color: #C0392B;\n}\n\n/* Edit Form Specific Styles */\n#task-list-root li.editing-mode {\n    border-left: 5px solid #557A95; /* Accent border for editing mode */\n    padding: 10px 15px; /* Adjust padding for form elements */\n}\n.task-edit-form {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    width: 100%;\n}\n.edit-input-group {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n}\n.edit-input-group input[type="text"],\n.edit-input-group select,\n.edit-input-group input[type="date"] {\n    flex-grow: 1;\n    padding: 8px 10px;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    font-size: 0.9em;\n}\n.edit-button-group {\n    display: flex;\n    justify-content: flex-end; /* Align buttons to the right */\n    gap: 8px;\n}\n.edit-button-group button {\n    padding: 8px 15px;\n    border-radius: 5px;\n    font-size: 0.9em;\n}\n.btn-save {\n    background-color: #2ECC71; /* Green for Save */\n    color: white;\n}\n.btn-save:hover {\n    background-color: #27AE60;\n}\n.btn-cancel {\n    background-color: #95A5A6; /* Grey for Cancel */\n    color: white;\n}\n.btn-cancel:hover {\n    background-color: #7F8C8D;\n}\n\n/* Sidebar Styling: Add Project Button */\n#add-project-btn {\n    /* Layout */\n    display: block; /* Make it take the full width available */\n    width: 100%;\n    margin-top: 10px;\n    \n    /* Appearance */\n    background-color: transparent; /* Start with no background */\n    color: #F6F7EB; /* Light text color */\n    border: 1px solid rgba(246, 247, 235, 0.3); /* Subtle light border */\n    padding: 8px 15px;\n    border-radius: 6px;\n    text-align: left;\n    font-weight: 500;\n    cursor: pointer;\n    font-size: 0.9em;\n    transition: background-color 0.2s, border-color 0.2s;\n}\n\n#add-project-btn:hover {\n    background-color: rgba(246, 247, 235, 0.1); /* Light background on hover */\n    border-color: #F6F7EB; /* Solid light border on hover */\n}\n\n/* Pending Count Styling */\n#pending-count {\n    background-color: #F1C40F; /* Yellow */\n    color: #393E41;\n    font-weight: bold;\n    padding: 5px 10px;\n    border-radius: 5px;\n    margin-top: 20px;\n    align-self: flex-start; /* Align it to the left */\n}\n\n\n/* Optional: Scrollbar Styling */\n::-webkit-scrollbar {\n    width: 8px;\n}\n::-webkit-scrollbar-track {\n    background: #f1f1f1;\n    border-radius: 10px;\n}\n::-webkit-scrollbar-thumb {\n    background: #888;\n    border-radius: 10px;\n}\n::-webkit-scrollbar-thumb:hover {\n    background: #555;\n}',""]);const i=s},601:t=>{t.exports=function(t){return t[1]}},659:t=>{var e={};t.exports=function(t,n){var o=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(o,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var a=e[o]={id:o,exports:{}};return t[o](a,a.exports,n),a.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var o=n(72),r=n.n(o),a=n(825),s=n.n(a),i=n(659),l=n.n(i),d=n(56),c=n.n(d),p=n(159),u=n.n(p),h=n(113),g=n.n(h),m=n(365),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=s(),b.insertStyleElement=u(),r()(m.A,b),m.A&&m.A.locals&&m.A.locals;class f{constructor(t,e="Medium",n=null,o=null){this.title=t,this.isComplete=!1,this.id=this.generateId(),this.priority=e,this.dueDate=n,this.projectName=o}toggleCompletion(){this.isComplete=!this.isComplete}generateId(){return Date.now().toString(36)+Math.random.toString(36).substring(2)}static fromData(t){const e=new f(t.title,t.priority||"Medium",t.dueDate||null,t.projectName||null);return e.isComplete=t.isComplete,e.id=t.id,e}}class k{constructor(t){this.tasks=[],this.storage=t,this.projects=this.storage.loadProjects()||[],this.loadAllTasks()}addProject(t){return!(!t||this.projects.includes(t)||(this.projects.push(t),this.storage.saveProjects(this.projects),0))}getProjects(){return this.projects}deleteProject(t){return!(!t||"Car Repair"===t||(this.projects=this.projects.filter(e=>e!==t),this.storage.saveProjects(this.projects),this.tasks.forEach(e=>{e.projectName===t&&(e.projectName=null)}),this.storage.saveTasks(this.tasks),0))}loadAllTasks(){const t=this.storage.loadTasks();this.tasks=t.map(t=>f.fromData(t))}addTask(t,e,n,o=null){if(!t)return;const r=new f(t,e,n,o);return this.tasks.push(r),this.storage.saveTasks(this.tasks),r}updateTask(t,e,n,o,r){const a=this.tasks.find(e=>e.id===t);if(a){a.title=e,a.priority=n,a.dueDate=o;const t=""===r?null:r;return a.projectName=t,this.storage.saveTasks(this.tasks),a}return null}deleteTask(t){this.tasks=this.tasks.filter(e=>e.id!==t),this.storage.saveTasks(this.tasks)}toggleCompletion(t){const e=this.tasks.find(e=>e.id===t);e&&(e.toggleCompletion(),this.storage.saveTasks(this.tasks))}getPendingCount(){return this.tasks.filter(t=>!t.isComplete).length}getTasks(t="Inbox"){let e=this.tasks;const n=new Date;n.setHours(0,0,0,0),e="Today"===t?this.tasks.filter(t=>{if(!t.dueDate)return!1;const e=new Date(t.dueDate);return e.setHours(0,0,0,0),e.toDateString()===n.toDateString()}):"This Week"===t?this.tasks.filter(t=>{if(!t.dueDate)return!1;const e=new Date(t.dueDate),o=new Date;return o.setDate(o.getDate()+7),e>=n&&e<=o}):"Inbox"===t?this.tasks.filter(t=>!t.projectName):"All Tasks"===t?this.tasks:this.tasks.filter(e=>e.projectName===t);const o={High:3,Medium:2,Low:1};return e.sort((t,e)=>{const n=o[t.priority]||0,r=o[e.priority]||0;if(r!==n)return r-n;const a=t.dueDate?new Date(t.dueDate).getTime():1/0,s=e.dueDate?new Date(e.dueDate).getTime():1/0;return a!==s?a-s:0})}}class x{loadTasks(){const t=localStorage.getItem("todo-tasks");return t?JSON.parse(t):[]}saveTasks(t){localStorage.setItem("todo-tasks",JSON.stringify(t))}saveProjects(t){localStorage.setItem("projects",JSON.stringify(t))}loadProjects(){return JSON.parse(localStorage.getItem("projects"))}}class v{constructor(t,e,n,o,r,a){this.task=t,this.isEditing=!1,this.onDeleteCallback=e,this.onToggleCallback=n,this.onUpdateCallback=o,this.onRenderNeededCallback=r,this.taskController=a}render(){const t=document.createElement("li");return t.id=this.task.id,this.task.isComplete&&t.classList.add("completed"),this.taskController.editingTaskId===this.task.id?(t.appendChild(this.createEditForm()),t.classList.add("editing-mode")):(t.appendChild(this.createDisplayView()),t.classList.remove("editing-mode")),t}createDisplayView(){const t=document.createDocumentFragment(),e=document.createElement("div");e.classList.add("task-title-container");const n=document.createElement("span");n.classList.add("task-priority",`priority-${this.task.priority.toLowerCase()}`),n.textContent=`[${this.task.priority}]`;const o=document.createElement("span");o.classList.add("task-due-date"),this.task.dueDate&&(o.textContent=`Due: ${this.task.dueDate}`);const r=document.createElement("span");r.classList.add("task-project-name"),this.task.projectName&&(r.textContent=`[Project: ${this.task.projectName}]`,r.classList.add("project-badge"));const a=document.createElement("span");a.textContent=this.task.title,e.appendChild(n),this.task.projectName&&e.appendChild(r),e.appendChild(o),e.appendChild(a);const s=document.createElement("input");s.setAttribute("type","checkbox"),s.checked=this.task.isComplete,s.addEventListener("change",()=>{this.onToggleCallback(this.task.id)});const i=document.createElement("button");i.textContent="Delete",i.classList.add("btn-del"),i.addEventListener("click",()=>{this.onDeleteCallback(this.task.id)});const l=document.createElement("div");l.classList.add("task-controls");const d=document.createElement("button");return d.textContent="Edit",d.classList.add("btn-edit"),d.addEventListener("click",()=>{this.onRenderNeededCallback(this.task.id)}),l.appendChild(s),l.appendChild(d),l.appendChild(i),t.appendChild(e),t.appendChild(l),t}createProjectSelect(){const t=this.taskController.taskManager.getProjects(),e=document.createElement("select");e.name="project",e.classList.add("edit-project-select");let n=document.createElement("option");return n.value="",n.textContent="Inbox / No Project",e.appendChild(n),t.forEach(t=>{let n=document.createElement("option");n.value=t,n.textContent=t,e.appendChild(n)}),this.task.projectName?e.value=this.task.projectName:e.value="",e}createEditForm(){const t=document.createElement("form");t.classList.add("task-edit-form");const e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("name","title"),e.value=this.task.title,e.required=!0,e.classList.add("edit-input-title");const n=document.createElement("select");n.setAttribute("name","priority"),n.classList.add("edit-input-priority"),["Low","Medium","High"].forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=t,this.task.priority===t&&(e.selected=!0),n.appendChild(e)});const o=document.createElement("input");o.setAttribute("type","date"),o.setAttribute("name","dueDate"),o.value=this.task.dueDate||"";const r=this.createProjectSelect(),a=document.createElement("button");a.setAttribute("type","submit"),a.textContent="Save",a.classList.add("btn-save");const s=document.createElement("button");s.setAttribute("type","button"),s.textContent="Cancel",s.classList.add("btn-cancel"),t.addEventListener("submit",t=>{t.preventDefault();const e=t.target.elements.title.value,n=t.target.elements.priority.value,o=t.target.elements.dueDate.value,a=r.value;this.onUpdateCallback(this.task.id,e,n,o,a),this.isEditing=!1}),s.addEventListener("click",()=>{this.onRenderNeededCallback(null)});const i=document.createElement("div");i.classList.add("edit-input-group"),i.appendChild(e),i.appendChild(n),i.appendChild(o),i.appendChild(r);const l=document.createElement("div");return l.classList.add("edit-button-group"),l.appendChild(a),l.appendChild(s),t.appendChild(i),t.appendChild(l),t}}class C{constructor(t,e,n,o,r,a,s,i){this.taskManager=t,this.rootElement=e,this.onDeleteCallback=n,this.onToggleCallback=o,this.countElement=r,this.onUpdateCallback=a,this.onRenderNeededCallback=s,this.taskController=i}render(){const t=this.taskController.getFilteredTasks();if(this.rootElement.innerHTML="",this.countElement){const t=this.taskManager.getPendingCount();this.countElement.textContent=t}t.forEach(t=>{const e=new v(t,this.onDeleteCallback,this.onToggleCallback,this.onUpdateCallback,this.onRenderNeededCallback,this.taskController).render();this.rootElement.appendChild(e)})}}class y{constructor(t,e){this.taskManager=t,this.taskListView=e,this.editingTaskId=null,this.currentFilter="All Tasks"}init(){this.bindEvents(),this.renderSidebar(),this.renderProjectDropdown(),this.setFilter(this.currentFilter)}handleProjectListClick=t=>{t.preventDefault();const e=t.target;if("SPAN"===e.tagName){const t=e.textContent.trim();this.setFilter(t),document.querySelectorAll("#sidebar .active").forEach(t=>t.classList.remove("active")),e.classList.add("active")}else if(e.classList.contains("delete-project-btn")){const t=e.closest("li");if(t){const e=t.querySelector("span").textContent.trim();this.handleDeleteProject(e)}}};renderProjectDropdown=()=>{const t=document.querySelector("#task-form");if(!t)return;const e=document.getElementById("task-project-select");e&&e.remove();const n=this.taskManager.getProjects(),o=document.createElement("select");o.name="project",o.id="task-project-select";let r=document.createElement("option");r.value="",r.textContent="Inbox / No Project",o.appendChild(r),n.forEach(t=>{let e=document.createElement("option");e.value=t,e.textContent=t,o.appendChild(e)});const a=t.querySelector("button");a?t.insertBefore(o,a):t.appendChild(o)};bindEvents(){document.querySelector("#task-form").addEventListener("submit",t=>{t.preventDefault(),this.handleAddTodo(t)}),document.querySelectorAll("#sidebar ul li a, #sidebar ul.project-list li span").forEach(t=>{t.addEventListener("click",t=>{t.preventDefault();const e=t.target.textContent.trim();this.setFilter(e)})}),document.querySelector("#add-project-btn").addEventListener("click",this.handleAddProject),document.querySelector(".project-list").addEventListener("click",this.handleProjectListClick)}handleAddProject=()=>{const t=prompt("Enter the name of the new project");if(t&&t.trim()){const e=t.trim();this.taskManager.addProject(e)?this.renderSidebar():alert(`Project "${e}" already exists or name is invalid.`)}};renderSidebar=()=>{const t=document.querySelector(".project-list");if(!t)return;const e=this.taskManager.getProjects();t.innerHTML="",e.forEach(e=>{const n=document.createElement("li"),o=document.createElement("span");o.textContent=e,o.classList.add("project-name-display");const r=document.createElement("button");r.textContent="X",r.classList.add("delete-project-btn"),n.appendChild(o),n.appendChild(r),t.appendChild(n)}),this.renderProjectDropdown()};handleDeleteProject=t=>{confirm(`Are you sure you want to delete the project "${t}"? All tasks in this project will be moved to the Inbox.`)&&(this.taskManager.deleteProject(t)?(this.setFilter("Inbox"),this.renderSidebar()):alert(`Cannot delete project: ${t}.`))};handleAddTodo(t){const e=t.target.elements.title.value,n=t.target.elements.priority.value,o=t.target.elements.dueDate.value,r=t.target.elements.project.value;this.taskManager.addTask(e,n,o,r),t.target.elements.title.value="",this.taskListView.render()}handleUpdateTask(t,e,n,o,r){e&&(this.taskManager.updateTask(t,e,n,o,r),this.editingTaskId=null,this.setFilter("All Tasks"))}triggerRender(t=null){this.editingTaskId=t,this.taskListView.render()}handleDeleteTodo(t){this.taskManager.deleteTask(t),this.taskListView.render()}handleToggleCompletion(t){this.taskManager.toggleCompletion(t),this.taskListView.render()}setFilter(t){console.log("SET FILTER CALLED:",t),this.currentFilter=t,this.editingTaskId=null,document.querySelectorAll("#sidebar .active").forEach(t=>t.classList.remove("active"));const e=document.querySelectorAll("#sidebar ul li a, #sidebar ul.project-list li span"),n=Array.from(e).find(e=>e.textContent.trim()===t);n&&n.classList.add("active"),this.taskListView.render()}getFilteredTasks(){return this.taskManager.getTasks(this.currentFilter)}}document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector("#task-list-root"),e=document.querySelector("#pending-count");if(!t)return void console.error("Fatal Error: Could not find the root element with ID 'task-list-root'. Check your HTML.");const n=new x,o=new k(n),r=new y(o,null),a=r.handleDeleteTodo.bind(r),s=r.handleToggleCompletion.bind(r),i=r.handleUpdateTask.bind(r),l=r.triggerRender.bind(r),d=new C(o,t,a,s,e,i,l,r);r.taskListView=d,r.init()})})();